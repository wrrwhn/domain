

  
    
  


  





  

<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.30.2 with theme Tranquilpeak 0.4.3-BETA">
    <title>Redis.Basic</title>
    <meta name="author" content="姚清居到此一游">
    <meta name="keywords" content=", 姚清居">

    <link rel="icon" href="logo.png">
    

    
    <meta name="description" content="参考  Redis Virtual Memory: the story and the code ​Virtual Memory technical specification  数据类型 Keys  del key1 key2&hellip; keyN  删除给定KEY  type key  返回当前key类型  keys pattern  匹配指定模式的所有KEY  randomkey  返回当前库随机KEY  rename oldkey newkey  重命名，若newkey存在则以oldkey值覆盖  renamenx oldkey newkey  重命名，但newkey存在时返回0  dbsize  返回当前数据库key数量  expire key seconds  为KEY指定过期时间  ttl key  返回设置过期时间的KEY的剩余时间  select db-index  通过索引选择数据库，默认为0，默认数据库个数16个  move key db-index  将当前库中的KEY移动至指定索引库中  flushdb  删除当前库中所有KEY，不会失败  flushall  删除所有库中的所有KEY，不会失败   String 特点  最基本类型，二进制安全，可包含任何数据，上限为一G字节">
    <meta property="og:description" content="参考  Redis Virtual Memory: the story and the code ​Virtual Memory technical specification  数据类型 Keys  del key1 key2&hellip; keyN  删除给定KEY  type key  返回当前key类型  keys pattern  匹配指定模式的所有KEY  randomkey  返回当前库随机KEY  rename oldkey newkey  重命名，若newkey存在则以oldkey值覆盖  renamenx oldkey newkey  重命名，但newkey存在时返回0  dbsize  返回当前数据库key数量  expire key seconds  为KEY指定过期时间  ttl key  返回设置过期时间的KEY的剩余时间  select db-index  通过索引选择数据库，默认为0，默认数据库个数16个  move key db-index  将当前库中的KEY移动至指定索引库中  flushdb  删除当前库中所有KEY，不会失败  flushall  删除所有库中的所有KEY，不会失败   String 特点  最基本类型，二进制安全，可包含任何数据，上限为一G字节">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Redis.Basic">
    <meta property="og:url" content="/2016/12/redis.basic/">
    <meta property="og:site_name" content="姚清居到此一游">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="姚清居到此一游">
    <meta name="twitter:description" content="参考  Redis Virtual Memory: the story and the code ​Virtual Memory technical specification  数据类型 Keys  del key1 key2&hellip; keyN  删除给定KEY  type key  返回当前key类型  keys pattern  匹配指定模式的所有KEY  randomkey  返回当前库随机KEY  rename oldkey newkey  重命名，若newkey存在则以oldkey值覆盖  renamenx oldkey newkey  重命名，但newkey存在时返回0  dbsize  返回当前数据库key数量  expire key seconds  为KEY指定过期时间  ttl key  返回设置过期时间的KEY的剩余时间  select db-index  通过索引选择数据库，默认为0，默认数据库个数16个  move key db-index  将当前库中的KEY移动至指定索引库中  flushdb  删除当前库中所有KEY，不会失败  flushall  删除所有库中的所有KEY，不会失败   String 特点  最基本类型，二进制安全，可包含任何数据，上限为一G字节">
    
    

    
    

    
      <meta property="og:image" content="http://otzm88f21.bkt.clouddn.com/45fdfc23-9844-433b-872c-dc78cddf7b21.png">
    

    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://wrrwhn.github.io/domain/css/style-jsjn0006wyhpyzivf6yceb31gvpjatbcs3qzjvlumobfnugccvobqwxnnaj8.min.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="3">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://wrrwhn.github.io/domain/">姚清居到此一游</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://wrrwhn.github.io/domain/#about">
    
    
    
      
        <img class="header-picture" src="http://otzm88f21.bkt.clouddn.com/45fdfc23-9844-433b-872c-dc78cddf7b21.png" alt="" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="3">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://wrrwhn.github.io/domain/#about">
          <img class="sidebar-profile-picture" src="http://otzm88f21.bkt.clouddn.com/45fdfc23-9844-433b-872c-dc78cddf7b21.png" alt="" />
        </a>
        <h4 class="sidebar-profile-name">姚清居到此一游</h4>
        
          <h5 class="sidebar-profile-bio"><a href="https://github.com/wrrwhn">https://github.com/wrrwhn</a></h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://wrrwhn.github.io/domain/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://wrrwhn.github.io/domain/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">分类</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://wrrwhn.github.io/domain/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">标签</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://wrrwhn.github.io/domain/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">归档</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://wrrwhn.github.io/domain/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">关于</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/wrrwhn" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://wrrwhn.github.io/domain/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="3"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Redis.Basic
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2016-12-10T22:07:46&#43;08:00">
        
   10, 2016

      </time>
    
    
  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              

<h2 id="参考">参考</h2>

<ul>
<li><a href="http://oldblog.antirez.com/post/redis-virtual-memory-story.html">Redis Virtual Memory: the story and the code</a></li>
<li>​<a href="http://redis.io/topics/internals-vm">Virtual Memory technical specification</a></li>
</ul>

<h2 id="数据类型">数据类型</h2>

<h3 id="keys">Keys</h3>

<ul>
<li>del key1 key2&hellip; keyN

<ul>
<li>删除给定KEY</li>
</ul></li>
<li>type key

<ul>
<li>返回当前key类型</li>
</ul></li>
<li>keys pattern

<ul>
<li>匹配指定模式的所有KEY</li>
</ul></li>
<li>randomkey

<ul>
<li>返回当前库随机KEY</li>
</ul></li>
<li>rename oldkey newkey

<ul>
<li>重命名，若newkey存在则以oldkey值覆盖</li>
</ul></li>
<li>renamenx oldkey newkey

<ul>
<li>重命名，但newkey存在时返回0</li>
</ul></li>
<li>dbsize

<ul>
<li>返回当前数据库key数量</li>
</ul></li>
<li>expire key seconds

<ul>
<li>为KEY指定过期时间</li>
</ul></li>
<li>ttl key

<ul>
<li>返回设置过期时间的KEY的剩余时间</li>
</ul></li>
<li>select db-index

<ul>
<li>通过索引选择数据库，默认为0，默认数据库个数16个</li>
</ul></li>
<li>move key db-index

<ul>
<li>将当前库中的KEY移动至指定索引库中</li>
</ul></li>
<li>flushdb

<ul>
<li>删除当前库中所有KEY，不会失败</li>
</ul></li>
<li>flushall

<ul>
<li>删除所有库中的所有KEY，不会失败</li>
</ul></li>
</ul>

<h3 id="string">String</h3>

<h4 id="特点">特点</h4>

<ul>
<li><p>最基本类型，二进制安全，可包含任何数据，上限为一G字节</p>

<h4 id="常用方法">常用方法</h4></li>

<li><p>set key value</p>

<ul>
<li>设置KEY对应的Sring类型值</li>
</ul></li>

<li><p>setnx key value</p>

<ul>
<li>若key不存在时设置，nx= not exists</li>
</ul></li>

<li><p>get key</p>

<ul>
<li>获取KEY对应Sring值</li>
</ul></li>

<li><p>getset key value</p>

<ul>
<li>原子设置KEY值，并返回原值</li>
</ul></li>

<li><p>mset key1 value1&hellip; keyN valueN</p>

<ul>
<li>批量写入</li>
</ul></li>

<li><p>msetnx key1 value1&hellip; keyN valueN</p>

<ul>
<li>批量写入，但不覆盖已有值</li>
</ul></li>

<li><p>mget key1 key2&hellip; keyN</p>

<ul>
<li>一次性获取多个KEY</li>
</ul></li>

<li><p>incr key</p>

<ul>
<li>key++</li>
</ul></li>

<li><p>decr key</p>

<ul>
<li>key&ndash;</li>
</ul></li>

<li><p>incrby key integer</p>

<ul>
<li>set key nvl(key, 0)+integer</li>
</ul></li>

<li><p>decrby key integer</p></li>

<li><p>substr key start end</p>

<ul>
<li>截取KEY的值，只读不改，且从0开始</li>
</ul></li>
</ul>

<h3 id="list">List</h3>

<h4 id="特点-1">特点</h4>

<ul>
<li>元素均为String类型的双向链接</li>
<li>[lr]push/[lr]pop/llen的时间复杂度均为O(1)</li>

<li><p>最大长度为2的32次方-1</p>

<h4 id="常用方法-1">常用方法</h4></li>

<li><p>l/rpush key string</p>

<ul>
<li>于key列表头部[尾部]添加元素</li>
</ul></li>

<li><p>llen key</p>

<ul>
<li>返回key列表长度</li>
</ul></li>

<li><p>lrange key start end</p>

<ul>
<li>返回key列表指定区间内的元素</li>
</ul></li>

<li><p>lset key index value</p>

<ul>
<li>设置key列表指定位置的元素值</li>
</ul></li>

<li><p>lrem key count value</p>

<ul>
<li>从左开始key列表中指定count个值为value的元素，若count=0表示清除所有</li>
</ul></li>

<li><p>l/rpop key</p>

<ul>
<li>于key列表的头部[尾部]移除元素</li>
</ul></li>

<li><p>blpop key1&hellip; keyN timeout</p>

<ul>
<li>从左至右扫描并返回第一个非空list进行lpop操作，若均为空或不存在，则阻塞timeout时间（若timeout=0则表示一直等待），并且于阻塞期间，若有记录插入其中一个列表，则立即对其执行lpop操作</li>
</ul></li>

<li><p>rpoplpush strkey destkey</p>

<ul>
<li>将strkey的尾部移除并插入destkey的头部，该操作为原子操作</li>
</ul></li>
</ul>

<h3 id="set">Set</h3>

<h4 id="特点-2">特点</h4>

<ul>
<li>string类型无序集合，最大可含2的32次方-1个元素</li>
<li>增删查因为hash table实现，复杂度均为O(1)</li>

<li><p>调整hash table大小需同步，会获取锁而阻塞其它读写操作。</p>

<h4 id="常用方法-2">常用方法</h4></li>

<li><p>sadd key member</p>

<ul>
<li>为数据添加元素</li>
</ul></li>

<li><p>stem key member</p>

<ul>
<li>移除指定数组中的指定元素</li>
</ul></li>

<li><p>spop key</p>

<ul>
<li>随机取除任一元素</li>
</ul></li>

<li><p>srandmember key</p>

<ul>
<li>随机读取任一元素</li>
</ul></li>

<li><p>smove strkey dstkey member</p>

<ul>
<li>将strkey数组中的member移动至dstkey数组中，原子操作。</li>
</ul></li>

<li><p>scard key</p>

<ul>
<li>返回数组元素个数</li>
</ul></li>

<li><p>sismember key member</p>

<ul>
<li>判断member是否为key数组的元素</li>
</ul></li>

<li><p>sinter key1..keyN</p>

<ul>
<li>返回数组的交集</li>
</ul></li>

<li><p>sinterstore dstkey key1..keyN</p>

<ul>
<li>存储sinter结果至dstkey</li>
</ul></li>

<li><p>sunion key1..keyN</p>

<ul>
<li>所有数组的并集集</li>
</ul></li>

<li><p>sunionstore dstkey key1..keyN</p>

<ul>
<li>存储sunion结果至dstkey</li>
</ul></li>

<li><p>sdiff key key1..keyN</p>

<ul>
<li>返回key中于其它数组中所不包含的元素</li>
</ul></li>

<li><p>sdfif dstkey key key1..keyN</p>

<ul>
<li>存储sdiff结果至dstkey</li>
</ul></li>

<li><p>smembers key</p>

<ul>
<li>返回key中所有元素</li>
</ul></li>
</ul>

<h3 id="sorted-set">Sorted Set</h3>

<h4 id="特点-3">特点</h4>

<ul>
<li>[score: double, value: string]</li>
<li>score映射至hash table，因此获取score的复杂度为O(1)</li>
<li>增删开销为O(log(N))</li>

<li><p>一般作为索引使用</p>

<h4 id="常用方法-3">常用方法</h4></li>

<li><p>zadd key score member</p>

<ul>
<li>添加元素到集合，若element存在则更新其score</li>
</ul></li>

<li><p>zrem key member</p>

<ul>
<li>移除集合中的element元素</li>
</ul></li>

<li><p>zincryby key incr member</p>

<ul>
<li>为集合中element元素的的score加上incr值，并调整list序列顺序</li>
</ul></li>

<li><p>z[rev]rank key member</p>

<ul>
<li>显示集合中member元素的排位</li>
</ul></li>

<li><p>z[rev]range key start end</p>

<ul>
<li>显示集合中指定区域的数值情况</li>
</ul></li>

<li><p>zcount key min max</p>

<ul>
<li>显示集中指定区域内的元素个数</li>
</ul></li>

<li><p>zcard key</p>

<ul>
<li>显示集合中无数的个数</li>
</ul></li>

<li><p>zscore key element</p>

<ul>
<li>显示集中中element元素对应的score值</li>
</ul></li>

<li><p>zremrangebyrank[score] key min max</p>

<ul>
<li>按排名[score]删除集合中给定区域的值</li>
</ul></li>
</ul>

<h3 id="hash">Hash</h3>

<h4 id="特点-4">特点</h4>

<ul>
<li>field/value映射表，适合存储对象，复杂度为平均O(1)</li>

<li><p>初始使用zipmap存储，待达到配置文件指定限制后转hash实现</p>

<h4 id="常用方法-4">常用方法</h4></li>

<li><p>hset key field value</p></li>

<li><p>hget key field</p></li>

<li><p>hmset key field1 value1..fieldN valueN</p></li>

<li><p>hmget key field1..fieldN</p></li>

<li><p>hexists key field</p></li>

<li><p>hdel key field</p></li>

<li><p>hlen/hkeys/hvals/hgetall key</p>

<ul>
<li>返回hash中的field数量/所有field/所有value/所有的field和value</li>
</ul></li>
</ul>

<h2 id="排序">排序</h2>

<h3 id="特点-5">特点</h3>

<ul>
<li><p>支持对list/set/sorted set进行排序操作</p>

<h3 id="格式">格式</h3></li>

<li><p><code>SORT key [BY pattern] [LIMIT start count] [GET pattern] [ASC|DESC] [ALPHA] [STORE dstkey]</code></p>

<h3 id="详解">详解</h3>

<ul>
<li><code>[BY pattern]</code></li>
<li>将集合元素内容按给定pattern组成新key后，按其对应的内容进行排序。</li>
<li>例

<ul>
<li><code>list uid= 1/2/3/4</code></li>
<li><code>set user_name_1[2/3/4]= admin[jack/peter/mary]</code></li>
<li><code>set user_level_1[2/3/4]= 99[32/80/9]</code></li>
<li><code>sort uid by user_name_*= 4/3/2/1</code></li>
<li><code>sort uid by user_level_*= 4/2/3/1</code></li>
</ul></li>
<li><code>[LIMIT start count]</code></li>
<li>限制返回由start开始的count个结果</li>
<li><code>[GET pattern]</code></li>
<li>返回pattern作为新值时的元素值。</li>
<li>例

<ul>
<li><code>sort uid get user_name*= nil/nil/nil/nil</code></li>
<li><code>sort uid get user_name_*= admin/jack/peter/mary</code></li>
</ul></li>
<li><code>[ASC|DESC]</code></li>
<li>指定排序方式，如bz/az/1/2或2/1/bz/az(desc)</li>
<li><code>[ALPHA]</code></li>
<li>按字母进行排序，如1/2/az/bc或bz/az/2/1(desc)</li>
<li><code>[STORE dstkey]</code></li>
<li>将结果以list方式保存</li>
<li><code>[KEY-&gt;FIELD]</code>`

<ul>
<li>于BY/GET pattern方式中使用，用于获取pattern组装值对应的域值</li>
<li>例

<ul>
<li><code>hmset user_info_1 name admin level 99</code></li>
<li><code>hmset user_info_2 name jack level 10</code></li>
<li><code>hmset user_info_3 name peter level 25</code></li>
<li><code>hmset user_info_4 name mary level 70</code>

<ul>
<li><code>sort uid user_info_*</code></li>
<li>-&gt; <code>desc get user_info_*</code></li>
<li>-&gt;name</li>
<li>按user<em>info</em>*中的等级进行降序排列，并输出对应位置的名称</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<h2 id="事务">事务</h2>

<h3 id="特点-6">特点</h3>

<ul>
<li>单线程来处理所有client请求</li>
<li>一般接到client发来的命令时立即处理并返回处理结果，但连接中发出multi命令后进入事务上下文，后续命令先放入队列中，并于接收到exec命令后执行所有并汇总打包所有 命令结果至client</li>
<li>事务中的写操作不能依赖于事务中的读操作结果，因为事务中命令只排队不立即执行</li>
</ul>

<h3 id="缺陷">缺陷</h3>

<ul>
<li>事务中一个命令失败，并不回滚其它命令</li>
<li>事务执行期间，redis挂了则后面事务丢失。

<ul>
<li>-&gt; 使用append-only file方式持久化，redis会使用单个write操作定稿事务内容，但仍存在部分写事务到磁盘。</li>
<li>而redis重启时会检测部分写入事务情况，并失败退出。</li>
<li>可用redis-chec-aof进行修复，删除部分写入的事务内容后重启即可。</li>
</ul></li>
</ul>

<h3 id="常用指令">常用指令</h3>

<ul>
<li>multi

<ul>
<li>开启事务上下文</li>
</ul></li>
<li>exec/discard

<ul>
<li>执行或放弃操作，结束事务上下文</li>
</ul></li>
<li>watch

<ul>
<li>整个连接内监听keys，可于事务exec前判断是否有keys值发生改变，而决定跳出事务。</li>
</ul></li>
</ul>

<h2 id="pipeline">pipeline</h2>

<h3 id="介绍">介绍</h3>

<ul>
<li>redis为cs模式的tcp server，使用类http请求响应协议。</li>
<li>支持一个client通过一个socket连接必起狐假虎威请求命令，并阻塞等待redis服务处理。</li>
<li>由于网络延迟等，客户端一秒可能只能发N条命令，但redis服务一秒可以执行远大N条的命令。</li>

<li><p>而pipeline便是将命令打包后一并发出一并处理的操作。</p>

<h3 id="注意事项">注意事项</h3></li>

<li><p>pipeline方式打包指令，redis须于处理完所有命令前无缓存所有命令处理结果，命令越多则缓存消耗内存越大。</p></li>
</ul>

<h3 id="代码">代码</h3>

<pre><code>ConnectionSpec spec = DefaultConnectionSpec.newSpec(&quot;192.168.56.55&quot;, 6379, 0, null);
JRedis jredis = new JRedisPipelineService(spec);
</code></pre>

<h2 id="持久化">持久化</h2>

<h3 id="特点-7">特点</h3>

<ul>
<li><p>支持持久化的内存数据库</p>

<h3 id="类型">类型</h3>

<h4 id="snapshooting-快照">Snapshooting（快照）</h4></li>

<li><p>默认方式</p></li>

<li><p>特点</p>

<ul>
<li>将内存数据以快照方式写入二进制文件，默认文件名为dump.rdb</li>
</ul></li>

<li><p>配置</p>

<ul>
<li><code>redis.conf-&gt; save time count</code>，若time秒内count个key被修改则发起快照保存</li>
</ul></li>

<li><p>流程</p>

<ul>
<li>redis调用fork，生成父子进程</li>
<li>父进程继续处理client请求，子进程负责将内存内容写入到临时文件。

<ul>
<li>由于os的写时复制机制(copy on write)父子进程会共享相同的物理页面。</li>
<li>当父进程处理写处理写请求时os会为父进程要修改的页面创建副本，而不是写共享页面。</li>
<li>所以子进程的地址空间内的数据是fork时刻整个数据库的一个快照。</li>
</ul></li>
<li>当子进程将快照写入临时文件完毕后，用临时文件替换原来的快照文件，然后子进程退出。</li>
</ul></li>

<li><p>注意</p>

<ul>
<li>client可使用save/bgsave通知redis做一次快照持久化。</li>
<li>save为主线程中保存快照，会阻塞所有client请求。</li>
<li>每次快照持久化均将内存数据完整写入，数据量大会影响IO性能。</li>
<li>由于快照一段时间操作一次，若redis意外down掉，会丢失最后一次快照后的所有修改。</li>
</ul></li>
</ul>

<h4 id="append-only-fill-aof">Append-only fill（aof）</h4>

<ul>
<li>特点

<ul>
<li>redis会将每一个收到的写命令都通过write函数追加至文件中，默认为appendonly.aof。redis重启时再重新执行文件命令来重建事个数据库。</li>
</ul></li>
<li>配置

<ul>
<li>redis.conf
<code>
appendonly yes    //启用aof持久化方式
#appendfsync always    //每次收到写命令就立即强制写入硬盘，最慢量最能保证完全持久化，不推荐
appendfsync everysec    //每秒钟强制写入磁盘一次，推荐使用
#appendfsync no            //完全依赖OS，性能最好，但无法保证持久化
</code></li>
</ul></li>
<li>流程

<ul>
<li>提供bgrewriteaof命令，要求redis使用快照方式将内存数据以命令方式保存至临时文件，最后替换原文件。</li>
<li>redis调用fork，生成父子两个进程</li>
<li>子进程根据内存中的数据库快照，往临时文件中写入重建数据库状态的命令</li>
<li>父进程继续处理client请求，将写命令写入aof文件并缓存起来（避免子进程重写失败）</li>
<li>子进程将快照内容写入命令方式的临时文件后，通知父进程将缓存写命令也写入</li>
<li>父进程将临时文件远的旧aof文件并重命令，同时继续往之追加写命令</li>
</ul></li>
<li>注意

<ul>
<li>只根据现有库记录写命令，不读旧AOF，相当于快照方式</li>
</ul></li>
</ul>

<h2 id="主从复制">主从复制</h2>

<h3 id="特点-8">特点</h3>

<ul>
<li>主从复制允许多个slave server拥有和master server相同的数据库脚本。</li>
<li>slave可以和master或其它slave相连。</li>

<li><p>主从复制不会阻塞master，而slave在初次同步时会阻塞。因此可通过多个slave专用于处理client的读请求以提高系统的可伸缩性。同时可限制master的数据持久化而转于slave上配置数据持久化。</p>

<h3 id="过程">过程</h3></li>

<li><p>配置好slave服务器后，slave自动建立与master的连接并发送sync命令。</p></li>

<li><p>master为slave创建后台进程，保存快照并缓存后续的写命令。</p></li>

<li><p>待快照完成后由master发送给slave，slave保存至本地后加载至内存恢复。后续master再将缓存写命令同样连接发送给slave。</p></li>

<li><p>slave和master连接断开时时自动重连，而多个slave同步连接时，仅会启动一个进程来写数据库镜像并发送给所有slave。</p>

<h3 id="配置">配置</h3></li>

<li><p><code>slaveof 192.168.1.1 6379</code></p>

<ul>
<li>指定master的ip和端口</li>
</ul></li>
</ul>

<h2 id="虚拟内存">虚拟内存</h2>

<h3 id="特点-9">特点</h3>

<ul>
<li>暂时将不经常访问的数据从内存交换到磁盘</li>

<li><p>不使用OS虚拟内存原因</p>

<ul>
<li>redis.obj远小于虚拟内存的最小单位4K，影响系统识别页面活跃情况而不利于资源回收</li>

<li><p>redis可将交换到磁盘的对象压缩（去除指针和对象元数据信息），比内存对象小10倍</p>

<h3 id="配置-1">配置</h3>

<pre><code>vm-enabled yes #开启vm功能
vm-swap-file /tmp/redis.swap #交换出来的value保存的文件路径/tmp/redis.swap
vm-max-memory 1000000 #redis使用的最大内存上限，超过上限后redis开始交换value到磁盘文件中。
vm-page-size 32 #每个页面的大小32个字节
vm-pages 134217728 #最多使用在文件中使用多少页面,交换文件的大小= vm-page-size * vm-pages
vm-max-threads 4 #用于执行value对象换入换出的工作线程数量。0表示不使用工作线程
</code></pre></li>
</ul></li>
</ul>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small"></span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://wrrwhn.github.io/domain/tags/%E6%95%B4%E7%90%86/">整理</a>

  <a class="tag tag--primary tag--small" href="https://wrrwhn.github.io/domain/tags/redis/">Redis</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://wrrwhn.github.io/domain/2016/12/java.%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF/" data-tooltip="Java.常用技术">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml"></span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://wrrwhn.github.io/domain/2016/12/oracle---%E5%9F%BA%E7%A1%80/" data-tooltip="Oracle - 基础">
              
                  <span class="hide-xs hide-sm text-small icon-mr"></span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  </div>


            
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2017 姚清居到此一游. 
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="3">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://wrrwhn.github.io/domain/2016/12/java.%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF/" data-tooltip="Java.常用技术">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml"></span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://wrrwhn.github.io/domain/2016/12/oracle---%E5%9F%BA%E7%A1%80/" data-tooltip="Oracle - 基础">
              
                  <span class="hide-xs hide-sm text-small icon-mr"></span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="3">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="http://otzm88f21.bkt.clouddn.com/45fdfc23-9844-433b-872c-dc78cddf7b21.png" alt="" />
    
    <h4 id="about-card-name">姚清居到此一游</h4>
    
      <div id="about-card-bio"><a href="https://github.com/wrrwhn">https://github.com/wrrwhn</a></div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Engineer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        中国-福建-厦门
      </div>
    
  </div>
</div>

    <div id="algolia-search-modal" class="modal-container">
  <div class="modal">
    <div class="modal-header">
      <span class="close-button"><i class="fa fa-close"></i></span>
      <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
        <span class="searchby-algolia-text text-color-light text-small">by</span>
        <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
      </a>
      <i class="search-icon fa fa-search"></i>
      <form id="algolia-search-form">
        <input type="text" id="algolia-search-input" name="search"
          class="form-control input--large search-input" placeholder="" />
      </form>
    </div>
    <div class="modal-body">
      <div class="no-result text-color-light text-center"></div>
      <div class="results">
        
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://wrrwhn.github.io/domain/2017/12/uml/">
                <h3 class="media-heading">UML</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"> [TOC]
UML 参考  看懂UML类图和时序图  大纲    使用  StarUML  UML.mdj   </div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://wrrwhn.github.io/domain/2017/12/linux.lsof/">
                <h3 class="media-heading">Linux.Lsof</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">参考  lsof 一切皆文件  功能  查看当前系统文件的工具 支持文件类型  普通文件 目录 网络文件系统的文件 字符或设备文件 函数共享库 管道、命名管道 符号链接 网络文件（NFS、Socket）   参数  -a  列出打开文件存在的进程  -c &lt;进程名&gt;  列出指定进程所打开的文件  -g  列出GID号进程详情  -d &lt;文件号&gt;  列出占用该文件号的进程  +d &lt;目录&gt;  列出目录下被打开的文件  +D &lt;目录&gt;  递归列出目录下被打开的文件  -n &lt;目录&gt;  列出使用NFS的文件  -i &lt;条件&gt;  列出符合条件的进程。（4、6、协议、:端口、 @ip）  -p &lt;进程号&gt;  列出指定进程号所打开的文件  -u  列出UID号进程详情  -h  显示帮助信息  -v  显示版本信息   示例  lsof | more  Result | COMMAND | PID | TID | USER | FD | TYPE | DEVICE | SIZE/OFF | NODE | NAME | |&mdash;&mdash;&mdash;-|&mdash;&mdash;&mdash;&mdash;|&mdash;&ndash;|&mdash;&mdash;&mdash;&mdash;|&mdash;&mdash;&mdash;&mdash;|&mdash;&mdash;&mdash;-|&mdash;&mdash;&mdash;-|&mdash;&mdash;&mdash;-|&mdash;&mdash;&mdash;-|&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;| | 进程名称 | 进程标识符 | | 进程所有者 | 文件描述符 | 文件类型 | 指定磁盘 | 文件大小 | 索引节点 | 打开文件的确切名称 | | systemd | 1 | | root | cwd | unknown | | | | /proc/1/cwd(readlink: Permission denied) | FD  cwd  表示current work dirctory，即应用程序的当前工作目录，这是该应用程序启动的目录，除非它本身对这个目录进行更改  txt  该类型的文件是程序代码，如应用程序二进制文件本身或共享库，如上列表中显示的 /sbin/init 程序  lnn  library references (AIX);  er  FD information error (see NAME column);  jld  jail directory (FreeBSD);  ltx  shared library text (code and data);  mxx  hex memory-mapped type number xx.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://wrrwhn.github.io/domain/2017/12/%E7%BD%91%E7%BB%9C-%E4%B8%83%E5%B1%82%E5%8D%8F%E8%AE%AE/">
                <h3 class="media-heading">网络-七层协议</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">参考  深入浅出－网络七层模型&amp;&amp;网络数据包 网络七层协议  定义  网络七层协议，理论模型 OSI（Open System Interconnection）    分层 应用层  直接为应用进程提供服务  根据提供的特性分组，称为服务元素  公共应用服务元素 CASE  所有用户可用，主要为应用进程通信，分页系统的基本控制机制  特定应用有服务元素 SASE  特定服务，如文卷传送、访问管理、银行业务等    示例  HTTP FTP SMTP/ POP3/ IMAP4 TELNET   表示层  定义数据格式、加密  如 FTP 下可选择以二进制或 ASCII 格式传输  懂中机通信的公共语言  IBM 主机使用 EBCDIC 编码 通用 PC 机采用 ASCII 码 转换以保证一致的数据形式  示例  ASCII EBCDIC  解决不同系统间的通信  LPP NBSSN   会话层  如何开始、同步和结束一个会话  使用校验点来保证通信失效后，由该校验点进行通信恢复 将会话地址映射为 IP 地址  示例  RPC SQL SSL TLS DAP   传输层  选择[无]差错恢复协议，在同一主机上对不同应用的数据流复用  对接收顺序有误的数据包排序  端对端数据的缓存层 面对会画层的界面端口 示例  TCP UDP SPX  端口通信    网络层  定义端对端的包传输 定义所有结点的逻辑地址，进行 路由|寻址 定义如何将包分解成更小的包的分段方法 示例  IP/ IPv6 EGP AHH/ ESP   数据链路层  定义在单个链路上如何传输、拆解包 每次通信时，建立起来的数据收发关系  链路连接的建立、拆除和分享 帧定界、同步 差错检测和恢复 链路标识、流量控制  示例  PPTP/ L2TP/ L2F/ ATMP ARP/ RARP  产品  网卡 网桥   物理层  为通信的两个数据终端设备提供连接，形成通路  将信息编码转换为电流脉冲或其它信号形式进行传输 方式  点对点 单点对多点 串行|并行 半双工|全双工 同步|异步   与传输介质有关  涉及连接头、帧、帧的使用、电流、编码、光调制等  示例  Rj45 将数据转换成 0|1 802.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://wrrwhn.github.io/domain/2017/12/%E7%BD%91%E7%BB%9C-%E5%9B%9B%E5%B1%82%E5%8D%8F%E8%AE%AE/">
                <h3 class="media-heading">网络-四层协议</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">参考  TCP/IP四层模型 深入浅出－网络七层模型&amp;&amp;网络数据包 TCP/IP四层模型 OSI七层和TCP/IP四层的关系  定义  网络事实上的标准 又名 TCP/IP 协议族或 TCP/IP 协议栈  Transmission Control Protocol 传输控制协议 Internet Protocol 互联网协议      分层 应用层  定义  = OSI.应用层+ OSI.表示层 + OSI.会话层  示例  FTP/ TELNET/ HTTP   传输层  定义  = OSI.传输层 对数据进行缓存、报文的拆解和重组  示例  TCP  传输控制协议 transmission control protocol  UDP  用户数据报协议 user datagram protocol    网间层  定义 = OSI.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://wrrwhn.github.io/domain/2017/12/%E4%B8%AD%E5%9B%BD-%E5%8E%A6%E9%97%A8-%E5%90%8C%E5%AE%89/">
                <h3 class="media-heading">中国-厦门-同安</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">参考  揣着100块钱来同安吃1整天！  路线  T4候机楼站 凤岗大肠国大肠血  BRT快2线，至同安枢纽站  阿呆盐鸭店  630A，由同安枢纽站至小西门  鑫旺旺汤包  步行  味源小吃  630A，由小西门至同安电视台站  台湾番婆冰  步行  肥栋满煎糕  步行  秀英食品  步行  双鹿老铺  步行  陆丰煎饼  612，由金安大厦至新西桥站  杨强芙蓉香骨鸡腿  625，由新西桥至同安劳动力市场站   介绍 凤岗大肠国  位置  凤岗岗头里786 同安枢纽站 直行50米左转进入凤岗路 直走600米  特色菜  纯猪血大肠  单价  15元/碗    阿呆盐鸭店  位置  小西门 下车前行50米后左转200米进入东山路  特色菜  盐鸭  单价  50元/只    鑫旺旺汤包  位置  沿着东山路走250米，进中山路再走200米  特色菜  汤包  单价  10元/笼    味源小吃  位置  同安电视台站  特色菜  碗仔粿  单价  3元/小碗 4元/大碗    台湾番婆冰  位置  沿着凤山路往南门桥走350米  特色菜  芒果冰 芋泥  单价  22元/芒果冰 6元/芋泥    肥栋满煎糕  位置  出了番婆冰右转20米就到  特色菜  满煎糕  单价  10元/个    秀英食品  位置  从番婆冰门口上桥，过桥左转沿路走到尽头右转300米，再右转上同新路，80米后左转直行100米  特色菜  醋肉  单价  20元/份    双鹿老铺  位置  从秀英出门右转到松柏林中路，200米后右转进南门路，再走70米  特色菜  马蹄酥  单价  6元/袋-10个    陆丰煎饼  位置  612路 金安大厦-新西桥站（2站） 步行到古庄大社里21号 下午三点开门  特色菜  煎饼  单价  4元/个 5.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://wrrwhn.github.io/domain/2017/12/%E4%BA%91%E5%BC%80-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%9E%B6%E6%9E%84-20171203/">
                <h3 class="media-heading">云开-服务端架构-20171203</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">流程  华山分享现有架构整理 志高补充压测等情况 讨论瓶颈优化  系统架构  客户端  微信 NW 老师端 PC 学习端  连接方式  HTTP TCP/IP  微服务  用户中心 直播相关 业务服务相关 推荐相关  模块  用户 直播  FFMpeg Nginx rtmp  NFS IM 转换  PPT  Gateway NSQ PPT.Command  音视频   底层服务  日志 持久化  Mysql，主从  缓存  Redis，仅主从无集群  文件数据   讨论  实现目标  两万人并发 目前900 QPS  确认瓶颈  缓存  解决方案  Twemproxy  参考  twitter/twemproxy Redis 存储分片之代理服务Twemproxy 测试 存储分片和Twemproxy核心解读  性能  性能损耗，最差低于 20%  优点  统一对外节点，多服务池 长连接，pipelinling 处理请求和响应，大大减少连接数 哈希分片，请求分配均匀  缺点  无法平滑地扩容或缩容 运维管理困难，无操作界面   Codis  参考  Redis集群技术及Codis实践 常见的redis集群方案有哪些优缺点？ []()  性能  最初比Twemproxy慢20%，现在比Twemproxy快近100%    优点  有图形化界面，扩容及运维方便 开发简单，对应用透明 不负责主从同步，轻量伦 提供 Jodis，支持 Java 程序的 HA  缺点  修改过 Redis 代码，无法与官方版本同步，新特性跟进缓慢 Value 字段大小小于 888B 字节时，性能较优秀 第三方组件较多     相关工作  AV-Server  可能存在问题？  CPU 使用率  GO 中使用  如何快速扩容  Kafka，多服务连接    Talk.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://wrrwhn.github.io/domain/2017/11/kafka/">
                <h3 class="media-heading">Kafka</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Nov 11, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Kafka 参考  Kafka剖析（一）：Kafka背景及架构介绍 Apache kafka 工作原理介绍 Quickstart Kafka系列2-producer和consumer报错 Using new consumer API with a Deserializer that throws SerializationException can lead to infinite loop How to find the kafka version in linux  简介  Linkedin 开发，Scala编写 特点  解耦 水平扩展 高吞吐率  缓冲 异步通信  可恢复性  冗余，确保安全保存至使用完毕后 处理消息进程宕机，仍可于启动后重新接收处理  顺序保证   架构 名词解析  Broker  集群中的服务器名称 支持水平扩展的节点  Topic  集群消息中类别  Partition  Topic 下包含一至多个 Partition  Producer  生产者 将消息发布至 Kafka broker  Consumer  消费者 向 Kafka broker 读消息的客户端  Consumer Group  各 Consumer 属于特定 Group 不指定时，则属于默认 Group   结构拓扑  整体拓扑    分析  kafka 通过 Zoopkeeper 管理集群配置  选举 Leader Consumer Group 变更时的 ReBalance  物理上 Topic 对应一至多个 Partition  每个 Partition 在物理上对应一个文件夹  消息 索引  结构  root 4k topic1-1 - 日志文件 root 4k topic1-2 .</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://wrrwhn.github.io/domain/2017/11/ffmpeg.%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/">
                <h3 class="media-heading">FFmpeg.阅读笔记</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Nov 11, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">[TOC]
简介  FFmpeg ffmpeg FFmpeg Formats Documentation FFmpeg - wiki FFmpeg - github 使用ffmpeg将视频转ts  概要  ffmpeg [global_options] {[input_file_options] -i input_url} ... {[output_file_options] output_url} ...  流程  _______ ______________ | | | | | input | demuxer | encoded data | decoder | file | ---------&gt; | packets | -----+ |_______| |______________| | v _________ | | | decoded | | frames | |_________| ________ ______________ | | | | | | | output | &lt;-------- | encoded data | &lt;----+ | file | muxer | packets | encoder |________| |______________|  选项 实例 裁剪  指令  ffmpeg -i old.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://wrrwhn.github.io/domain/2017/11/git.subtree/">
                <h3 class="media-heading">Git.Subtree</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Nov 11, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">参考  Git Subtree的使用 Git Tools - Subtree Merging 用 Git Subtree 在多个 Git 项目间双向同步子项目，附简明使用手册  描述  简介 &gt; 经由 Git Subtree 来维护的子项目代码，对于父项目来说是透明的，所有的开发人员看到的就是一个普通的目录，原来怎么做现在依旧那么做，只需要维护这个 Subtree 的人在合适的时候去做同步代码的操作。
 适用情况
 使用 github 的 page 功能实现项目主页功能，结合 hugo 生成 public 文件夹后同步到 gh-pages 分支，作为分支完整内容 项目 A 和项目 B 存在公用模块，A 中的修改、新增等操作，均同步至项目 B  可用方案
 Git Submodule  Git 官方早期推荐方案 允许其它仓库指定 commit 嵌入仓库子目录  但需要 init 和 update  产生 .gitmodule 文件记录 submodule 版本信息 删除较费劲  Git Subtree  Git 1.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://wrrwhn.github.io/domain/2017/11/20%E5%B2%81%E7%9A%84%E4%BD%A0/">
                <h3 class="media-heading">20岁的你</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Nov 11, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"> [TOC]
20岁时做什么到40岁时才不会后悔？ 要点  知道什么是生命中最重要的东西 尽量不要去想太多竞争 善待那些喜欢自己的人 学会欣赏这个世界 为健康打下基础 试错和重启 谨慎选择与谁一起共度 谨防短期情绪波动 一定要把收入的一部分用于储蓄 投资 写作将点燃你的头脑 要建立良好的个人品牌 设计你的生活永远不会太迟 没有人把一切都想通了  忧虑就是你在偿还你并未欠的债 - 马克吐温  了解，沟通是一切 提问 如果你发现自己不知道或不确定，就主动发问吧 做饭 冥想让头脑深度休息 更新你的心灵的操作系统  关键字  健康、控制情绪 尝试  投资理财 做饭  提问、思考、设计人生  </div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
      </div>
    </div>
    <div class="modal-footer">
      <p class="results-count text-medium"
         data-message-zero=""
         data-message-one=""
         data-message-other="">
         132 posts found
      </p>
    </div>
  </div>
</div>
    
  
    
    <div id="cover" style="background-image:url('https://wrrwhn.github.io/domain/images/cover.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://wrrwhn.github.io/domain/js/script-qi9wbxp2ya2j6p7wx1i6tgavftewndznf4v0hy2gvivk1rxgc3lm7njqb6bz.min.js"></script>



<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
  



    
  </body>
</html>

