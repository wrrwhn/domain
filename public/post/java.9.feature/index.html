<!doctype html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>好久不见</title>
        <meta name="author">
        <meta name="description" content="好久不见">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="generator" content="Hugo 0.30.2" />
        <link href="http://domain.yqjdcyy.com/post/index.xml" rel="alternate" type="application/rss+xml" title="好久不见" />
        <link href="http://domain.yqjdcyy.com/post/index.xml" rel="feed" type="application/rss+xml" title="好久不见" />
        <link href='//fonts.googleapis.com/css?family=Roboto:400,300,700|Noto+Serif:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="http://domain.yqjdcyy.com/css/styles.css">
        <link rel="icon" href="http://domain.yqjdcyy.com/favicon.ico">
        <link rel="apple-touch-icon" href="http://domain.yqjdcyy.com/apple-touch-icon.png" />
        <link rel="stylesheet" href="http://domain.yqjdcyy.com/css/highlightjs/monokai.css">
        <script src="http://domain.yqjdcyy.com/js/vendor/modernizr-2.8.0.min.js"></script>
        
        <style>
        .site-header h2 .logo {
        background: url(http://domain.yqjdcyy.com/img/desk.jpg) no-repeat 0 0;
        }
        @media (min--moz-device-pixel-ratio: 1.3), (-o-min-device-pixel-ratio: 2.6 / 2), (-webkit-min-device-pixel-ratio: 1.3), (min-device-pixel-ratio: 1.3), (min-resolution: 1.3dppx) {
          .site-header h2 .logo {
            background-image: url(http://domain.yqjdcyy.com/img/desk.jpg);
        }}
       .site-header {
         background: #2a373d url(http://domain.yqjdcyy.com/img/desk.jpg) no-repeat center center;
         z-index: -1;
        }
        </style>
    </head>
    <body>
        
        <header class="site-header">
          <div class="transparent-layer">
              <h2></h2>
          </div>
        </header>


<div class="container clearfix">
    <main role="main" class="content">
        <article class="post">
            <a class="btn home" href="http://domain.yqjdcyy.com/" title="">&laquo; </a>
            
<h1><a href="http://domain.yqjdcyy.com/post/java.9.feature/" title="Java.9.Feature">Java.9.Feature</a></h1>

<footer class="post-info"> <span class="post-meta"><time datetime="2017.11.16">2017.11.16</time>

    &middot; 
        
        <a href="http://domain.yqjdcyy.com/tags/%E9%98%85%E8%AF%BB">阅读</a>, 
        
        <a href="http://domain.yqjdcyy.com/tags/java">java</a>
        
    

</span>
</footer>

            

<h1 id="深入解读-java-9-新特性">深入解读 Java 9 新特性</h1>

<h2 id="参考">参考</h2>

<ul>
<li><a href="https://mp.weixin.qq.com/s/ivj2SmTZqr5qVfPbauPZxg">深入解读 Java 9 新特性</a></li>
<li><a href="http://www.importnew.com/16353.html">Java9先睹为快：JShell动手实践</a></li>
<li><a href="http://www.infoq.com/cn/news/2016/09/JavaOne-2016-Keynote-JShell">JavaOne 2016——观众得以一睹JShell的威力</a></li>
</ul>

<h2 id="jigsaw">Jigsaw</h2>

<ul>
<li><p>核心
-实现 Java 平台模块化系统
    - JPMS (Java Platform Module System)</p></li>

<li><p>针对问题</p>

<ul>
<li>易错的 classpath

<ul>
<li>应用不同部分依赖同一类库的<code>不同版本</code></li>
<li><code>ClassLoading</code> 复杂而<code>不明确</code>，导致 ClassNotFoundException、 NoClassDefFoundError 等异常</li>
</ul></li>
<li>JDK 过于臃肿，无法按不同需求进行定制或优化</li>
</ul></li>

<li><p>目标</p>

<ul>
<li>可靠配置

<ul>
<li>明确模块边界和模块间的依赖关系</li>
</ul></li>
<li>强封装性

<ul>
<li>通过封装模块内部私有细节，避免不希望发生的依赖关系</li>
</ul></li>
</ul></li>

<li><p>拆分 JDK 增强提议 (JEP)</p>

<ul>
<li><code>JEP 261</code>

<ul>
<li>Module System，实现<code>模块化系统</code>；</li>
</ul></li>
<li><code>JEP 200</code>

<ul>
<li>The Modular JDK，将<code>JDK</code>自身进行<code>模块化</code>；</li>
</ul></li>
<li><code>JEP 201</code>

<ul>
<li>Modular Source Code，按照模块化的形式，<code>重构源代码,</code>因为现有代码并不是划分到一个一个的模块里的。</li>
</ul></li>
<li><code>JEP 220</code>

<ul>
<li>Modular Run-Time Images，重新<code>设计</code>JDK和JRE的<code>结构</code>，定义新的URI scheme操作模块，类和资源（jrt）。</li>
</ul></li>
<li><code>JEP 260</code>

<ul>
<li>Encapsulate Most Internal APIs，按照<code>模块化封装性</code>的要求，将不希望暴露的内部API封装起来，如果确实证明是广泛需要的，就作为公共API公开出来。</li>
</ul></li>
<li><code>JEP 282</code>

<ul>
<li>jlink: The Java Linker。新的<code>link</code>工具</li>
</ul></li>
</ul></li>

<li><p>模块图</p>

<ul>
<li><img src="http://otzm88f21.bkt.clouddn.com/ecd7a640-92c5-4a5f-b32d-8674be84e8e7.png" alt="java.se.ee-graph.png" /></li>
</ul></li>

<li><p>开发角度</p>

<ul>
<li>工具和 API 新增或修改，用以编译、链接和运行时的模块支持</li>
<li>Java/ Javac 等增加对模块的支持，支持 module path</li>
<li>Java9 增加可选链接阶段 (Linking Phase)，创建最小依赖关系的 Java 运行时</li>
</ul></li>

<li><p>示例</p>

<ul>
<li><code>jlink</code>
<code>
$ jlink --module-path jmods/ \
            --add-modules java.sql.rowset,java.activation \
            --output myimage
$ myimage/bin/java --list-modules
    java.activation@9
    java.base@9
    java.datatransfer@9
    java.logging@9
    java.naming@9
    java.security.sasl@9
    java.sql@9
    java.sql.rowset@9
    java.xml@9
$ myimage/bin/java –m company.application
</code></li>
</ul></li>
</ul>

<h2 id="类库新特性">类库新特性</h2>

<ul>
<li><p>工具 API</p>

<ul>
<li><code>JEP 102</code>

<ul>
<li>Process API Updates</li>
<li>新增 <code>ProcessHandle</code> 抽象，优化 <code>Process</code> 扩展，以提升对进程操作的支持
<code>
ProcessHandle current = ProcessHandle.current();
current.info()
   .totalCpuDuration()
   .ifPresent(d -&gt; System.out.println(&quot;Total cpu duration :&quot; + d));
current.children()
   .forEach(p -&gt; System.out.println(&quot;Pid:&quot; + p.getPid()));
</code></li>
</ul></li>

<li><p><code>JEP 269</code></p>

<ul>
<li>Convenience Factory Methods for Collections</li>
<li>针对集合的工厂方法优化</li>
<li><code>Set&lt;String&gt; alphabet = Set.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;);</code></li>
</ul></li>

<li><p><code>JEP 166</code></p>

<ul>
<li>Java 并发(Concurrency)API 更新</li>
<li>最小集合 API 以支持 <code>Reactive Stream</code>

<ul>
<li>Flow API= Publisher + Subscriber+ Processor</li>
</ul></li>
<li>异步方式处理数据流</li>
</ul></li>
</ul></li>

<li><p>新标准或协议支持</p>

<ul>
<li>安全

<ul>
<li><code>JEP 219</code>

<ul>
<li>支持Datagram Transport Layer Security (DTLS)。</li>
<li>支持DTLS version 1.0 (RFC 4347) and 1.2 (RFC 6347)，以提供安全的UDP传输。</li>
<li>目前，基于UDP实现的类似SIP或者电子游戏协议，被证明是很有实际价值的。</li>
</ul></li>
<li><code>JEP 229</code>

<ul>
<li>默认keystore格式从JKS替换为PKCS12。</li>
</ul></li>
<li><code>JEP 244</code>

<ul>
<li>TLS Application-Layer Protocol Negotiation(ALPN) Extension, 这是完整支持HTTP/2协议的前提之一。</li>
</ul></li>
<li><code>JEP 249</code>

<ul>
<li>支持OCSP Stapling for TLS，减少证书状态验证的网络开销，提高性能。</li>
</ul></li>
<li><code>JEP 273</code>

<ul>
<li>实现基于DRBG的SecureRandom，对于Deterministic Random Bit Generator (DRBG) 机制，您可以参考NIST 800-90Ar1相关文档。</li>
</ul></li>
<li><code>JEP 287</code>

<ul>
<li>SHA-3 Hash Algorithms。</li>
</ul></li>
</ul></li>
<li>网络

<ul>
<li><code>JEP 110</code>

<ul>
<li>HTTP/2 client API，支持 HTTP 1.1，HTTP/2 和 WebSocket协议，实现了全新的 HTTP client API，用于替换老旧的HttpURLConnection</li>
<li>支持同步和异步操作模式，充分利用了 Reactive style 编程</li>
</ul></li>
</ul></li>
<li>编码

<ul>
<li><code>JEP 227</code>

<ul>
<li>Unicode 7.0</li>
</ul></li>
<li><code>JEP 267</code>

<ul>
<li>Unicode 8.0</li>
</ul></li>
<li><code>JEP 226</code>

<ul>
<li>UTF-8 Property Files</li>
</ul></li>
</ul></li>
</ul></li>

<li><p>性能优化</p>

<ul>
<li><code>JEP 254</code>

<ul>
<li>Compact String，Java 9 中，修改 String 实现，以 byte[] 数组和一个编码标记替换 char[] (16 bits) 数组</li>
<li><code>Latin</code> 语系编码字符串会<code>节省近半空间</code>。</li>
<li>这个修改对 API 的使用者完全透明。</li>
</ul></li>
<li><code>JEP 232</code>

<ul>
<li>提高安全应用性能。</li>
<li>开启 <code>security manager</code> 通常会导致10-15%的性能下降，<code>Java 9</code>的改进显著降低了开销。</li>
<li>优化包括用标准的并发容器替换自定义的同步逻辑，或者去掉不必要的检查等等。</li>
</ul></li>
<li><code>JEP 24</code>

<ul>
<li>利用CPU指令优化GHASH和RSA。</li>
<li>充分利用Intel x64或者SPARC CPU的部分新指令。</li>
<li>部分加密函数的性能提高非常显著

<ul>
<li>在 benchmark 中，相比于 JDK 8，AES 性能提高了至少 8 倍。</li>
<li>这是相对保守的数据，测试数据大多在几十倍提升。</li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<h2 id="语言和工具的变化">语言和工具的变化</h2>

<ul>
<li><code>Jshell</code>

<ul>
<li>简单易用的交互式执行 Java 代码</li>
<li><img src="http://otzm88f21.bkt.clouddn.com/75dc6d1b-1996-403e-b5f9-e3e5fe736abe.png" alt="99b03cecbd2c9cca2f320ed778ba2f09.png" /></li>
</ul></li>
<li><code>Multi-Release JAR Files</code>

<ul>
<li>扩展 JAR 文件格式，支持不同版本 class 文件共存</li>
<li><code>release</code>指令

<ul>
<li><code>Javac --release N</code></li>
<li>= <code>Javac -source N -target N -bootclasspath rtN.jar</code></li>
</ul></li>
</ul></li>
<li><code>Javadoc Search</code></li>
</ul>

<h2 id="jvm-领域新特性">JVM 领域新特性</h2>

<ul>
<li><p><code>将 G1 作为默认垃圾收集器</code></p>

<ul>
<li>目前 server 模式的默认选项是 <code>ParallelGC</code>= <code>吞吐量优先</code></li>
<li>延迟比吞吐量更能提高用户体验，<code>G1</code> 可以直接设定延迟目标，达到延迟 SLA 要求</li>
<li>最坏场景的延迟表现优于 <code>CMS</code> = <code>设计原理导致碎片化问题</code></li>
</ul></li>

<li><p><code>AOT</code></p>

<ul>
<li><code>Ahead-of-Time Compilation</code>= <code>提前编译</code></li>
<li>利用新的编译工具 <code>jaotc</code>，把 <code>class</code> 编译成类似类库的文件

<ul>
<li>编译

<ul>
<li><code>aotc –output libHelloWorld.so HelloWorld.clas</code></li>
</ul></li>
<li>使用

<ul>
<li><code>java -XX:AOTLibrary=./libHelloWorld.so HelloWorld</code></li>
</ul></li>
</ul></li>
<li>实验阶段，目前支持 Linux 64 平台</li>
<li>不能直接编译成可执行文件，还需要结合 <code>Jlink</code> 或 <code>JavaPackager</code></li>
</ul></li>

<li><p><code>移除过时的GC组合</code></p>

<ul>
<li>移除在JDK 8中标记过时的 <code>Incremental CMS</code>= <code>iCMS</code></li>
<li>输入 <code>java</code> 不支持的参数，将于<code>启动阶段</code>直接<code>报错</code></li>
</ul></li>

<li><p><code>统一日志</code></p>

<ul>
<li>引入适用于 <code>JVM</code> 各个模块的通用日志机制</li>
<li>在此基础上解决过于碎片化的 <code>JVM</code> 日志选项。</li>
</ul></li>

<li><p><code>JVM 性能优化</code></p>

<ul>
<li><code>改进竞争锁</code>

<ul>
<li>改进高度竞争的 <code>Java Object Monitor</code> 性能</li>
</ul></li>
<li><code>Spin-Wait Hints</code>

<ul>
<li>循环等待提示</li>
</ul></li>
<li><code>Thread.onSpinWait()</code></li>
</ul></li>
</ul>

<h2 id="java-发布模式">Java 发布模式</h2>

<ul>
<li>切换到以时间驱动

<ul>
<li>六个月周期

<ul>
<li>针对企业需求</li>
</ul></li>
<li>三年周期

<ul>
<li>Long Term Support</li>
</ul></li>
</ul></li>
</ul>

            <ul class="share-buttons">
    <li></li>
    <li>
        <a class="icon-facebook-squared" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fdomain.yqjdcyy.com%2fpost%2fjava.9.feature%2f" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-twitter" href="https://twitter.com/share?text=Java.9.Feature&amp;url=http%3a%2f%2fdomain.yqjdcyy.com%2fpost%2fjava.9.feature%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-gplus" href="https://plus.google.com/share?url=http%3a%2f%2fdomain.yqjdcyy.com%2fpost%2fjava.9.feature%2f" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fdomain.yqjdcyy.com%2fpost%2fjava.9.feature%2f&title=Java.9.Feature" onclick="window.open(this.href, 'linkedin-share', 'width=600,height=494');return false;" title=""></a>
    </li>
</ul>

        </article>
        
        <div class="comments">
            <h3></h3>
            <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "yqjdcyy-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
        
    </main>
    <aside class="author">
  <img class="profile-image" src="http://domain.yqjdcyy.com/img/profile-image.png" alt="姚清居" />
  <p class="name"> 
  <strong>姚清居</strong></p>
  <p class="address">Earth</p>
  <p class="link"></p>
  <ul class="social">
    












<li><a href="//github.com/wrrwhn" class="icon-github" target="_blank" title="Github"></a></li>




<li><a href="http://domain.yqjdcyy.com/post/index.xml" class="icon-rss" target="_blank" title="RSS"></a></li>

  </ul>
  <br><br>
</aside>

</div>

<footer class="main-footer">
  <div class="container clearfix">
        <a class="icon-rss" href="http://domain.yqjdcyy.com/post/index.xml" title="RSS"></a>
        <p>&copy; 2018 &middot; Powered by <a href="http://www.domain.yqjdcyy.com">姚清居</a>.</p>
  </div>
</footer>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>window.jQuery || document.write('<script src="http:\/\/domain.yqjdcyy.com\/js\/vendor\/jquery-1.11.0.min.js"><\/script>')</script>
<script src="http://domain.yqjdcyy.com/js/plugins.js"></script>




</body>
</html>

