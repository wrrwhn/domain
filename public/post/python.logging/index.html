<!doctype html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>好久不见</title>
        <meta name="author">
        <meta name="description" content="好久不见">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="generator" content="Hugo 0.30.2" />
        <link href="http://domain.yqjdcyy.com/post/index.xml" rel="alternate" type="application/rss+xml" title="好久不见" />
        <link href="http://domain.yqjdcyy.com/post/index.xml" rel="feed" type="application/rss+xml" title="好久不见" />
        <link href='//fonts.googleapis.com/css?family=Roboto:400,300,700|Noto+Serif:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="http://domain.yqjdcyy.com/css/styles.css">
        <link rel="icon" href="http://domain.yqjdcyy.com/favicon.ico">
        <link rel="apple-touch-icon" href="http://domain.yqjdcyy.com/apple-touch-icon.png" />
        <link rel="stylesheet" href="http://domain.yqjdcyy.com/css/highlightjs/monokai.css">
        <script src="http://domain.yqjdcyy.com/js/vendor/modernizr-2.8.0.min.js"></script>
        
        <style>
        .site-header h2 .logo {
        background: url(http://domain.yqjdcyy.com/img/desk.jpg) no-repeat 0 0;
        }
        @media (min--moz-device-pixel-ratio: 1.3), (-o-min-device-pixel-ratio: 2.6 / 2), (-webkit-min-device-pixel-ratio: 1.3), (min-device-pixel-ratio: 1.3), (min-resolution: 1.3dppx) {
          .site-header h2 .logo {
            background-image: url(http://domain.yqjdcyy.com/img/desk.jpg);
        }}
       .site-header {
         background: #2a373d url(http://domain.yqjdcyy.com/img/desk.jpg) no-repeat center center;
         z-index: -1;
        }
        </style>
    </head>
    <body>
        
        <header class="site-header">
          <div class="transparent-layer">
              <h2></h2>
          </div>
        </header>


<div class="container clearfix">
    <main role="main" class="content">
        <article class="post">
            <a class="btn home" href="http://domain.yqjdcyy.com/" title="">&laquo; </a>
            
<h1><a href="http://domain.yqjdcyy.com/post/python.logging/" title="Python.Logging">Python.Logging</a></h1>

<footer class="post-info"> <span class="post-meta"><time datetime="2018.04.11">2018.04.11</time>

    &middot; 
        
        <a href="http://domain.yqjdcyy.com/tags/%E6%95%B4%E7%90%86">整理</a>, 
        
        <a href="http://domain.yqjdcyy.com/tags/python">python</a>
        
    

</span>
</footer>

            

<p>[TOC]</p>

<h1 id="组成">组成</h1>

<h2 id="logger">Logger</h2>

<ul>
<li>作用

<ul>
<li>日志对外暴露接口</li>
</ul></li>

<li><p>创建</p>

<ul>
<li><p><code>logger = logging.getLogger(logger_name)</code></p>

<h2 id="handler">Handler</h2></li>
</ul></li>

<li><p>作用</p>

<ul>
<li>将日志内容转至相应文件</li>
</ul></li>

<li><p>类型</p>

<ul>
<li>StreamHandler

<ul>
<li><code>sh = logging.StreamHandler(stream=None)</code></li>
</ul></li>
<li>FileHandler

<ul>
<li><code>fh = logging.FileHandler(filename, mode='a', encoding=None, delay=False)</code></li>
</ul></li>

<li><p>NullHandler</p>

<h2 id="filter">Filter</h2></li>
</ul></li>

<li><p>作用</p>

<ul>
<li><p>将日志内容进行过滤</p>

<h2 id="formater">Formater</h2></li>
</ul></li>

<li><p>作用</p>

<ul>
<li>控制日志输出格式</li>
</ul></li>

<li><p>LogRecord.对象</p>

<ul>
<li><code>name</code>

<ul>
<li>日志记录器名称</li>
<li>不会因 Handler 将其转到其它 Logger 而改变</li>
</ul></li>
<li><code>level</code>

<ul>
<li>日志级别名称</li>
<li>如<code>INFO</code>、<code>ERROR</code></li>
</ul></li>
<li><code>pathname</code>

<ul>
<li>源文件的完整路径名称</li>
</ul></li>
<li><code>lineno</code>

<ul>
<li>调用处在源文件中行号</li>
</ul></li>
<li><code>msg</code>

<ul>
<li>日志消息体</li>
</ul></li>
<li><code>args</code>

<ul>
<li>参数+ 日志消息体</li>
</ul></li>
<li><code>exc_info</code>

<ul>
<li>当前异常信息</li>
</ul></li>
<li><code>func</code>

<ul>
<li>调用处所在的方法体名称</li>
</ul></li>
</ul></li>

<li><p>LogRecord.参数</p>

<table>
<thead>
<tr>
<th>Attribute</th>
<th>Format</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>asctime</td>
<td>%(asctime)s</td>
<td>LogRecord创建时间的人为识别格式<br/>如2003-07-08 16:49:45,896</td>
</tr>

<tr>
<td>created</td>
<td>%(created)f</td>
<td>LogRecord创建时间的时间戳格式</td>
</tr>

<tr>
<td>msecs</td>
<td>%(msecs)d</td>
<td>LogRecord创建时间的毫秒部分</td>
</tr>

<tr>
<td>relativeCreated</td>
<td>%(relativeCreated)d</td>
<td>LogRecord的已创建时长</td>
</tr>

<tr>
<td>pathname</td>
<td>%(pathname)s</td>
<td>源文件的完整路径名</td>
</tr>

<tr>
<td>filename</td>
<td>%(filename)s</td>
<td><code>pathname</code>的文件名部分</td>
</tr>

<tr>
<td>module</td>
<td>%(module)s</td>
<td><code>filename</code> 的部分</td>
</tr>

<tr>
<td>funcName</td>
<td>%(funcName)s</td>
<td>调用方法名</td>
</tr>

<tr>
<td>levelname</td>
<td>%(levelname)s</td>
<td>&lsquo;DEBUG&rsquo;, &lsquo;INFO&rsquo;, &lsquo;WARNING&rsquo;, &lsquo;ERROR&rsquo;, &lsquo;CRITICAL&rsquo;</td>
</tr>

<tr>
<td>levelno</td>
<td>%(levelno)s</td>
<td><code>levelname</code> 的对应数值</td>
</tr>

<tr>
<td>lineno</td>
<td>%(lineno)d</td>
<td>源文件中报错行所在行的号码</td>
</tr>

<tr>
<td>message</td>
<td>%(message)s</td>
<td>LogRecord.msg &amp; LogRecord.args</td>
</tr>

<tr>
<td>name</td>
<td>%(name)s</td>
<td>所使用的日志记录器名称</td>
</tr>

<tr>
<td>process</td>
<td>%(process)d</td>
<td>进程 ID</td>
</tr>

<tr>
<td>processName</td>
<td>%(processName)d</td>
<td>进程名称</td>
</tr>

<tr>
<td>thread</td>
<td>%(thread)d</td>
<td>线程 ID</td>
</tr>

<tr>
<td>threadName</td>
<td>%(threadName)s</td>
<td>线程名称</td>
</tr>
</tbody>
</table></li>

<li><p>示例</p>

<ul>
<li><code>logging.basicConfig(format=&quot;%(asctime)-15s %(clientip)s %(user)-8s %(message)s&quot;)</code>
<br /></li>
</ul></li>
</ul>

<h1 id="补充">补充</h1>

<h2 id="日志级别">日志级别</h2>

<ul>
<li><p>明细</p>

<table>
<thead>
<tr>
<th>Level</th>
<th>Usage</th>
<th>Value</th>
</tr>
</thead>

<tbody>
<tr>
<td>NOTSET</td>
<td></td>
<td>0</td>
</tr>

<tr>
<td>DEBUG</td>
<td>调试时的信息输出</td>
<td>10</td>
</tr>

<tr>
<td>INFO</td>
<td>运行状态、信息输出</td>
<td>20</td>
</tr>

<tr>
<td>WARNING</td>
<td>预警消息<br/>如磁盘将满，费用不足等</td>
<td>30</td>
</tr>

<tr>
<td>ERROR</td>
<td>运行时相关异常消息</td>
<td>40</td>
</tr>

<tr>
<td>CRITICAL</td>
<td>运行失败消息</td>
<td>50</td>
</tr>
</tbody>
</table></li>
</ul>

<h2 id="配置方法">配置方法</h2>

<ul>
<li>默认配置</li>
<li>简单配置

<ul>
<li><code>logging.basicConfig(filename='20180411.log', level=logging.INFO,
                format='%(asctime)-15s %(levelname)s %(filename)s \t%(lineno)d \t%(message)s')</code></li>
</ul></li>
<li>文件配置

<ul>
<li><code>logging.config.fileConfig(&quot;path&quot;)</code></li>
</ul></li>
<li>字典配置

<ul>
<li><code>logging.config.dictConfig(config)</code></li>
</ul></li>
<li>网络配置

<ul>
<li>略</li>
</ul></li>
</ul>

<h2 id="流程">流程</h2>

<ul>
<li><img src="http://otzm88f21.bkt.clouddn.com/be92d65e-86d8-49e3-be7c-296e02426a99.png" alt="logging_flow.png" /></li>
</ul>

<h1 id="示例">示例</h1>

<h2 id="代码配置">代码配置</h2>

<ul>
<li><p>Code</p>

<pre><code>import logging

logger = logging.getLogger('example')
logger.setLevel(logging.DEBUG)

ch = logging.StreamHandler()
ch.setLevel(logging.DEBUG)
formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
ch.setFormatter(formatter)
logger.addHandler(ch)

logger.debug('debug message')
logger.info('info message')
logger.warn('warn message')
logger.error('error message')
logger.critical('critical message')
</code></pre></li>

<li><p>Output</p>

<pre><code>2005-03-19 15:10:26,618 - example - DEBUG - debug message
2005-03-19 15:10:26,620 - example - INFO - info message
2005-03-19 15:10:26,695 - example - WARNING - warn message
2005-03-19 15:10:26,697 - example - ERROR - error message
2005-03-19 15:10:26,773 - example - CRITICAL - critical message
</code></pre></li>
</ul>

<h2 id="配置文件">配置文件</h2>

<ul>
<li><p>Config</p>

<ul>
<li>logging.conf
```
[loggers]
keys=root,example</li>
</ul>

<p>[handlers]
keys=consoleHandler</p>

<p>[formatters]
keys=simpleFormatter</p>

<p>[logger_root]
level=DEBUG
handlers=consoleHandler</p>

<p>[logger_example]
level=DEBUG
handlers=consoleHandler
qualname=example
propagate=0</p>

<p>[handler_consoleHandler]
class=StreamHandler
level=DEBUG
formatter=simpleFormatter
args=(sys.stdout,)</p>

<p>[formatter_simpleFormatter]
format=%(asctime)s - %(name)s - %(levelname)s - %(message)s
datefmt=</p>

<pre><code>- logging.yqml
</code></pre>

<p>version: 1
formatters:
  simple:
    format: &lsquo;%(asctime)s - %(name)s - %(levelname)s - %(message)s&rsquo;
handlers:
  console:
    class: logging.StreamHandler
    level: DEBUG
    formatter: simple
    stream: ext://sys.stdout
loggers:
  simpleExample:
    level: DEBUG
    handlers: [console]
    propagate: no
root:
  level: DEBUG
  handlers: [console]
```</p></li>

<li><p>Code</p>

<pre><code>import logging
import logging.config

logging.config.fileConfig('logging.conf')
logger = logging.getLogger('example')

logger.debug('debug message')
logger.info('info message')
logger.warn('warn message')
logger.error('error message')
logger.critical('critical message')
</code></pre></li>

<li><p>Output</p>

<ul>
<li>同<code>代码配置</code>模块输出</li>
</ul></li>
</ul>

<h2 id="对象配置">对象配置</h2>

<ul>
<li><p>Code</p>

<pre><code>import logging
import logging.config

DEFAULT_LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'loggers': {
        '': {
            'level': 'INFO',
        },
        'another.module': {
            'level': 'DEBUG',
        },
    }
}

logging.config.dictConfig(DEFAULT_LOGGING)
logging.info('Hello, log')
</code></pre></li>

<li><p>Detail</p>

<pre><code>{ 
    'version': 1,
    'disable_existing_loggers': False,
    'formatters': { 
        'standard': { 
            'format': '%(asctime)s [%(levelname)s] %(name)s: %(message)s'
        },
    },
    'handlers': { 
        'default': { 
            'level': 'INFO',
            'formatter': 'standard',
            'class': 'logging.StreamHandler',
        },
    },
    'loggers': { 
        '': { 
            'handlers': ['default'],
            'level': 'INFO',
            'propagate': True
        },
        'django.request': { 
            'handlers': ['default'],
            'level': 'WARN',
            'propagate': False
        },
    } 
}
</code></pre></li>
</ul>

<h1 id="参考">参考</h1>

<h2 id="官方">官方</h2>

<ul>
<li><a href="https://docs.python.org/2/howto/logging.html">Logging HOWTO</a></li>
<li><a href="https://docs.python.org/2/library/logging.html#formatter-objects">Formatter Objects</a></li>

<li><p><a href="https://docs.python.org/2/library/logging.html#logrecord-attributes">LogRecord attributes</a></p>

<h2 id="整理">整理</h2></li>

<li><p><a href="https://www.jianshu.com/p/feb86c06c4f4">python logging模块使用教程</a></p></li>

<li><p><a href="http://pythonguidecn.readthedocs.io/zh/latest/writing/logging.html">日志（Logging）</a></p></li>
</ul>

            <ul class="share-buttons">
    <li></li>
    <li>
        <a class="icon-facebook-squared" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fdomain.yqjdcyy.com%2fpost%2fpython.logging%2f" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-twitter" href="https://twitter.com/share?text=Python.Logging&amp;url=http%3a%2f%2fdomain.yqjdcyy.com%2fpost%2fpython.logging%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-gplus" href="https://plus.google.com/share?url=http%3a%2f%2fdomain.yqjdcyy.com%2fpost%2fpython.logging%2f" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fdomain.yqjdcyy.com%2fpost%2fpython.logging%2f&title=Python.Logging" onclick="window.open(this.href, 'linkedin-share', 'width=600,height=494');return false;" title=""></a>
    </li>
</ul>

        </article>
        
        <div class="comments">
            <h3></h3>
            <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "yqjdcyy-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
        
    </main>
    <aside class="author">
  <img class="profile-image" src="http://domain.yqjdcyy.com/img/profile-image.png" alt="姚清居" />
  <p class="name"> 
  <strong>姚清居</strong></p>
  <p class="address">Earth</p>
  <p class="link"></p>
  <ul class="social">
    












<li><a href="//github.com/yqjdcyy" class="icon-github" target="_blank" title="Github"></a></li>




<li><a href="http://domain.yqjdcyy.com/post/index.xml" class="icon-rss" target="_blank" title="RSS"></a></li>

  </ul>
  <br><br>
</aside>

</div>

<footer class="main-footer">
  <div class="container clearfix">
        <a class="icon-rss" href="http://domain.yqjdcyy.com/post/index.xml" title="RSS"></a>
        <p>&copy; 2018 &middot; Powered by <a href="http://www.domain.yqjdcyy.com">姚清居</a>.</p>
  </div>
</footer>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>window.jQuery || document.write('<script src="http:\/\/domain.yqjdcyy.com\/js\/vendor\/jquery-1.11.0.min.js"><\/script>')</script>
<script src="http://domain.yqjdcyy.com/js/plugins.js"></script>




</body>
</html>

