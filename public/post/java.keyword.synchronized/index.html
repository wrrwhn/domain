<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> 
    <title>Java.Keyword.Synchronized - 好久不见</title>
    <meta name="keywords" content="好久不见,博客,程序,思考,笔记,分享">
    
    <meta property="og:title" content="Java.Keyword.Synchronized">
    <meta property="og:site_name" content="好久不见">
    <meta property="og:image" content="/img/author.jpg"> 
    <meta name="title" content="Java.Keyword.Synchronized - 好久不见" />
    <meta name="description" content="好久不见 | 博客 | 程序 | 思考 | 笔记 | 分享"> 
    
    <link rel="shortcut icon" href="http://domain.yqjdcyy.com/img/favicon.ico" />
    <link rel="apple-touch-icon" href="http://domain.yqjdcyy.com/img/apple-touch-icon.png" />
    <link rel="apple-touch-icon-precomposed" href="http://domain.yqjdcyy.com/img/apple-touch-icon.png" />
    <link href="http://domain.yqjdcyy.com/js/vendor/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />
    <link href="http://domain.yqjdcyy.com/js/vendor/fancybox/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />
    <link href="http://domain.yqjdcyy.com/css/main.css" rel="stylesheet" type="text/css" />
    <link href="http://domain.yqjdcyy.com/css/syntax.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
     fancybox: true, 
    motion: true
  };
</script>
</head>
<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">
<div class="container one-collumn sidebar-position-left page-home  ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-meta  custom-logo ">

  <div class="custom-logo-site-title">
    <a href="http://domain.yqjdcyy.com/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">好久不见</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">生之所向</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
    <ul id="menu" class="menu">
      
      
        <li class="menu-item ">
          <a href="http://domain.yqjdcyy.com/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://domain.yqjdcyy.com/categories/%E6%95%B4%E7%90%86/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-code"></i> <br />整理
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://domain.yqjdcyy.com/categories/%E9%98%85%E8%AF%BB/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-tint"></i> <br />阅读
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://domain.yqjdcyy.com/categories/%E4%B9%90%E8%B6%A3/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-tint"></i> <br />乐趣
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://domain.yqjdcyy.com/about/%E5%85%B3%E4%BA%8E/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于
          </a>
        </li>
      
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger"> <i class="menu-item-icon fa fa-search fa-fw"></i> <br /> 搜索</a>
      </li>
    </ul>
    <div class="site-search">
      <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>

    </div>
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
<section id="posts" class="posts-expand">
  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
      <h1 class="post-title" itemprop="name headline">
        <a class="post-title-link" href="http://domain.yqjdcyy.com/post/java.keyword.synchronized/" itemprop="url">
        Java.Keyword.Synchronized
        </a>
      </h1>
      <div class="post-meta">
      <span class="post-time">
<span class="post-meta-item-icon">
    <i class="fa fa-calendar-o"></i>
</span>
<span class="post-meta-item-text">时间：</span>
<time itemprop="dateCreated" datetime="2016-03-22T13:04:35+08:00" content="2019-01-01">
    2019-01-01
</time>
</span> 
      

  <span class="post-category" >
  &nbsp; | &nbsp;
  <span class="post-meta-item-icon">
    <i class="fa fa-folder-o"></i>
  </span>
  <span class="post-meta-item-text">分类：</span>
  
    <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
      <a href="http://domain.yqjdcyy.com/categories/%E6%95%B4%E7%90%86" itemprop="url" rel="index">
        <span itemprop="name">整理</span>
      </a>
      &nbsp; 
    </span>
  
</span>


       <span>
&nbsp; | &nbsp;
<span class="post-meta-item-icon">
    <i class="fa fa-eye"></i>
</span>
<span class="post-meta-item-text">阅读：</span>
<span class="leancloud-visitors-count">1588 字 ~4分钟</span>
</span>
      </div>
    </header>
    <div class="post-body" itemprop="articleBody">
    

<h1 id="文档">文档</h1>

<h2 id="synchronized">synchronized</h2>

<ul>
<li><p>原文</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">The Java Virtual Machine supports synchronization of both methods and sequences of instructions within a method by a single synchronization construct: the monitor.

Method-level synchronization is performed implicitly, as part of method invocation and return (§2.11.8). A synchronized method is distinguished in the run-time constant pool&#39;s method_info structure (§4.6) by the ACC_SYNCHRONIZED flag, which is checked by the method invocation instructions. When invoking a method for which ACC_SYNCHRONIZED is set, the executing thread enters a monitor, invokes the method itself, and exits the monitor whether the method invocation completes normally or abruptly. During the time the executing thread owns the monitor, no other thread may enter it. If an exception is thrown during invocation of the synchronized method and the synchronized method does not handle the exception, the monitor for the method is automatically exited before the exception is rethrown out of the synchronized method.
Synchronization of sequences of instructions is typically used to encode the synchronized block of the Java programming language. The Java Virtual Machine supplies the monitorenter and monitorexit instructions to support such language constructs. Proper implementation of synchronized blocks requires cooperation from a compiler targeting the Java Virtual Machine (§3.14).

Structured locking is the situation when, during a method invocation, every exit on a given monitor matches a preceding entry on that monitor. Since there is no assurance that all code submitted to the Java Virtual Machine will perform structured locking, implementations of the Java Virtual Machine are permitted but not required to enforce both of the following two rules guaranteeing structured locking. Let T be a thread and M be a monitor. Then:

The number of monitor entries performed by T on M during a method invocation must equal the number of monitor exits performed by T on M during the method invocation whether the method invocation completes normally or abruptly.

At no point during a method invocation may the number of monitor exits performed by T on M since the method invocation exceed the number of monitor entries performed by T on M since the method invocation.

Note that the monitor entry and exit automatically performed by the Java Virtual Machine when invoking a synchronized method are considered to occur during the calling method&#39;s invocation.</pre></div></li>

<li><p>理解</p>

<ul>
<li><code>synchronized</code> 结构通过 <code>monitor</code> 支持方法和块的同步的实现</li>
<li>方法级同步

<ul>
<li>于调用和返回时隐性支持</li>
<li>存储于运行时静态池的 <code>method_info</code> 时，会添加以 <code>ACC_SYNCHRONIZED</code> 标志

<ul>
<li>方法调用时，检测到有 <code>ACC_SYNCHRONIZED</code> 标志时，将让执行线程进入 <code>monitor</code>，并于调用结束或异常抛出前退出 <code>monitor</code></li>
<li>而当该线程拥有此 <code>monitor</code>时，其它线程将无法进入</li>
</ul></li>
</ul></li>
<li>块级同步

<ul>
<li>JVM 通过 <code>monitorenter</code> 和 <code>monitorexit</code> 来支持块的同步

<ul>
<li>两个指令需要数量匹配</li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<h1 id="示例">示例</h1>

<h2 id="同步方法">同步方法</h2>

<ul>
<li><p><code>SynchronizedTest.java</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">synchronized</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">print</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;synchronized method&#34;</span><span style="color:#f92672">);</span>
<span style="color:#f92672">}</span></code></pre></div></li>

<li><p><code>javap -verbose SynchronizedTest.class</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">synchronized</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
  descriptor: <span style="color:#f92672">()</span>V
  flags: ACC_PUBLIC<span style="color:#f92672">,</span> ACC_SYNCHRONIZED
  Code:
    stack<span style="color:#f92672">=</span>2<span style="color:#f92672">,</span> locals<span style="color:#f92672">=</span>1<span style="color:#f92672">,</span> args_size<span style="color:#f92672">=</span>1
       0: getstatic     <span style="color:#960050;background-color:#1e0010">#</span>2                  <span style="color:#75715e">// Field java/lang/System.out:Ljava/io/PrintStream;
</span><span style="color:#75715e"></span>       3: ldc           <span style="color:#960050;background-color:#1e0010">#</span>3                  <span style="color:#75715e">// String synchronized method
</span><span style="color:#75715e"></span>       5: invokevirtual <span style="color:#960050;background-color:#1e0010">#</span>4                  <span style="color:#75715e">// Method java/io/PrintStream.println:(Ljava/lang/String;)V
</span><span style="color:#75715e"></span>       8: <span style="color:#66d9ef">return</span>
    LineNumberTable:
      line 12: 0
      line 13: 8</code></pre></div></li>
</ul>

<h2 id="同步块">同步块</h2>

<ul>
<li><p><code>SynchronizedTest.java</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">say</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">synchronized</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;synchronized block&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span></code></pre></div></li>

<li><p><code>javap -verbose SynchronizedTest.class</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">say</span><span style="color:#f92672">();</span>
  descriptor: <span style="color:#f92672">()</span>V
  flags: ACC_PUBLIC
  Code:
    stack<span style="color:#f92672">=</span>2<span style="color:#f92672">,</span> locals<span style="color:#f92672">=</span>3<span style="color:#f92672">,</span> args_size<span style="color:#f92672">=</span>1
       0: aload_0
       1: dup
       2: astore_1
       3: monitorenter
       4: getstatic     <span style="color:#960050;background-color:#1e0010">#</span>2                  <span style="color:#75715e">// Field java/lang/System.out:Ljava/io/PrintStream;
</span><span style="color:#75715e"></span>       7: ldc           <span style="color:#960050;background-color:#1e0010">#</span>5                  <span style="color:#75715e">// String synchronized block
</span><span style="color:#75715e"></span>       9: invokevirtual <span style="color:#960050;background-color:#1e0010">#</span>4                  <span style="color:#75715e">// Method java/io/PrintStream.println:(Ljava/lang/String;)V
</span><span style="color:#75715e"></span>      12: aload_1
      13: monitorexit
      14: <span style="color:#66d9ef">goto</span>          22
      17: astore_2
      18: aload_1
      19: monitorexit
      20: aload_2
      21: athrow
      22: <span style="color:#66d9ef">return</span></code></pre></div></li>
</ul>

<h1 id="补充">补充</h1>

<h2 id="jvm-object">JVM.Object</h2>

<table>
<thead>
<tr>
<th>存储位置</th>
<th>内容</th>
<th>明细</th>
</tr>
</thead>

<tbody>
<tr>
<td>Heap</td>
<td></td>
<td></td>
</tr>

<tr>
<td></td>
<td>Object.Instance</td>
<td></td>
</tr>

<tr>
<td></td>
<td></td>
<td>HotSpot.Header<br>头信息</td>
</tr>

<tr>
<td></td>
<td></td>
<td>Instance.Data<br>实例数据<br>相同宽度的分配在一起</td>
</tr>

<tr>
<td></td>
<td></td>
<td>对齐填充数据<br>JVM 要求对象大小必须是 8B 的整数倍</td>
</tr>
</tbody>
</table>

<h2 id="hotspot-header">HotSpot.Header</h2>

<h3 id="通用版本">通用版本</h3>

<table>
<thead>
<tr>
<th>组成</th>
<th>字段</th>
<th>描述</th>
</tr>
</thead>

<tbody>
<tr>
<td>标记字段<br>Mark word</td>
<td></td>
<td>size= JVM.bits(<sup>32</sup>&frasl;<sub>64</sub>)</td>
</tr>

<tr>
<td></td>
<td>*Stack.Lock</td>
<td>指向锁记录的指针</td>
</tr>

<tr>
<td></td>
<td>Stack.Lock.statuc</td>
<td>锁状态标志</td>
</tr>

<tr>
<td></td>
<td>*Object.Monitor</td>
<td>指向重量级锁的指针</td>
</tr>

<tr>
<td></td>
<td>HashCode</td>
<td>哈希码值</td>
</tr>

<tr>
<td></td>
<td>Age</td>
<td>GC 分代年龄</td>
</tr>

<tr>
<td></td>
<td>Thread.ID</td>
<td>偏向线程 ID</td>
</tr>

<tr>
<td></td>
<td>epoch</td>
<td></td>
</tr>

<tr>
<td>类型指针<br>Klass Pointer</td>
<td></td>
<td>可通过句柄访问或直接访问</td>
</tr>
</tbody>
</table>

<h3 id="官方版本">官方版本</h3>

<ul>
<li><img src="http://doc.yqjdcyy.com/2bc2d37b-60f0-4705-a5f9-28e3a66e9d73.png" alt="JVM_Object_Header.png" /></li>
</ul>

<h3 id="锁版本">锁版本</h3>

<ul>
<li><p>此处以「官方版本」的 32bits 为例</p>

<ul>
<li><img src="http://doc.yqjdcyy.com/7020b9a1-7894-4dac-9581-dab260686770.png" alt="JVM_Object_Header_Lock.png" /></li>
</ul></li>
</ul>

<h2 id="header-lock">Header.Lock</h2>

<h3 id="锁状态">锁状态</h3>

<table>
<thead>
<tr>
<th>名称</th>
<th>锁标志</th>
<th>偏向锁标志</th>
<th>描述</th>
</tr>
</thead>

<tbody>
<tr>
<td>无锁状态</td>
<td>01</td>
<td>0</td>
<td></td>
</tr>

<tr>
<td>轻量级锁</td>
<td>00</td>
<td></td>
<td></td>
</tr>

<tr>
<td>重量级锁</td>
<td>10</td>
<td></td>
<td>多个线程竞争锁<br>线程通过自旋以循环获取锁</td>
</tr>

<tr>
<td>GC 标记</td>
<td>11</td>
<td></td>
<td></td>
</tr>

<tr>
<td>偏向锁</td>
<td>01</td>
<td>1</td>
<td>单进程同步时使用<br>减少不必要的轻量级锁依赖<br>相对节省多次 CAS 原子操作</td>
</tr>
</tbody>
</table>

<h3 id="升级">升级</h3>

<ul>
<li>单向</li>
<li>次序

<ul>
<li>无锁</li>
<li>偏向锁</li>
<li>轻量锁</li>
<li>重量锁</li>
</ul></li>
</ul>

<h3 id="流程">流程</h3>

<ul>
<li><p>「轻量级锁-重量级锁」升级过程</p>

<ul>
<li>Record.Lock

<ul>
<li>代码开始同步时，若同步对象为无锁状态，则 VM 将于当前线程建立锁记录 <code>Lock Record</code></li>
<li>锁记录中存储对象的 <code>Mark word</code> 的拷贝，又名 <code>Displaced Mark Word</code></li>
</ul></li>
<li>COPY

<ul>
<li>将对象实现状况的 <code>Mark Word</code> 拷贝至栈帧的锁记录中</li>
</ul></li>
<li>CAS

<ul>
<li>VM 尝试使用 CAS 将对象实例的 <code>Mark Word</code> 更新指向锁记录，并将锁记录的 <code>owner</code> 指针指向对象实例的 <code>Mark Word</code></li>
</ul></li>
<li>CAS.Success

<ul>
<li>将锁状态更新为轻量级锁</li>
</ul></li>
<li>CAs.Fail

<ul>
<li>首先检查是否对象实例的 <code>Mark Word</code> 是否已经指向栈帧

<ul>
<li>如果是，则说明已经拥有该对象的锁，开始同步操作</li>
</ul></li>
<li>确认为多线程竞争，膨胀为重量级锁，并将 <code>Mark Word</code> 指向 <code>Object.Monitor</code></li>
</ul></li>
</ul></li>

<li><p>「无锁-偏向锁-轻量级锁」升级过程</p>

<ul>
<li>Biased_Lock

<ul>
<li>前置条件</li>
<li>判断 <code>Mark Word</code> 中的偏向锁标志是否开启</li>
</ul></li>
<li>Biased.Lock== 1 and Thread.ID== this.iD

<ul>
<li>若可偏向，且偏向进程 ID 为当前进程 ID，则竞选结束，继续执行同步代码</li>
</ul></li>
<li>CAS

<ul>
<li>通过 CAS 操作竞争锁</li>
</ul></li>
<li>CAS.Success

<ul>
<li>将 <code>Mark Word</code> 中的进程 ID 更新为当前进程 ID</li>
<li>继续执行同步代码</li>
</ul></li>
<li>CAS.Fail

<ul>
<li>判断有多个进程在竞争</li>
<li>升级为轻量级锁

<ul>
<li>时机

<ul>
<li>为全局安全点

<ul>
<li>SafePoint</li>
<li>无字节码正在执行</li>
</ul></li>
</ul></li>
<li>操作

<ul>
<li>挂起获得偏向锁的进程</li>
<li>偏向锁升级为轻量级锁</li>
<li>阻塞线程继续执行同步代码</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<h3 id="图示">图示</h3>

<ul>
<li><p>偏向锁版本</p>

<ul>
<li><img src="http://doc.yqjdcyy.com/95b86b47-6c70-4dac-86fb-015d7bdcaf97.png" alt="Java.Synchronized.Biased.png" /></li>
</ul></li>

<li><p>完整版本</p>

<ul>
<li><img src="http://doc.yqjdcyy.com/eb603ae6-15d7-416a-86a3-62fba06acac8.jpg" alt="java-synchronized.jpg" /></li>
</ul></li>
</ul>

<h2 id="自旋锁">自旋锁</h2>

<ul>
<li><p>描述</p>

<ul>
<li>互斥情况下，线程 A 获得锁后，线程 B 申请，则 B 阻塞等待</li>
<li>而如若线程上下文的切换成本，较之锁竞争的成本更高，则可让 B 不放弃 CPU 原地等待持有者 A 释放锁</li>
</ul></li>

<li><p>问题</p>

<ul>
<li>占据 CPU 时长过度</li>
<li>死锁</li>
<li>ABA 异常</li>
</ul></li>

<li><p>场景</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SpinLock</span> <span style="color:#f92672">{</span>

  <span style="color:#66d9ef">private</span> AtomicReference<span style="color:#f92672">&lt;</span>Thread<span style="color:#f92672">&gt;</span> sign <span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> AtomicReference<span style="color:#f92672">&lt;&gt;();</span>

  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">lock</span><span style="color:#f92672">(){</span>
    Thread current <span style="color:#f92672">=</span> Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">currentThread</span><span style="color:#f92672">();</span>
    <span style="color:#66d9ef">while</span><span style="color:#f92672">(!</span>sign <span style="color:#f92672">.</span><span style="color:#a6e22e">compareAndSet</span><span style="color:#f92672">(</span><span style="color:#66d9ef">null</span><span style="color:#f92672">,</span> current<span style="color:#f92672">)){</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span>

  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">unlock</span> <span style="color:#f92672">(){</span>
    Thread current <span style="color:#f92672">=</span> Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">currentThread</span><span style="color:#f92672">();</span>
    sign <span style="color:#f92672">.</span><span style="color:#a6e22e">compareAndSet</span><span style="color:#f92672">(</span>current<span style="color:#f92672">,</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">);</span>
  <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div></li>
</ul>

<h1 id="参考">参考</h1>

<ul>
<li><a href="http://www.hollischuang.com/archives/1883">Synchronized的实现原理</a></li>
<li><a href="https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html#jvms-2.11.10">2.11.10. Synchronization</a></li>
<li><a href="https://www.cnblogs.com/kundeg/p/8422557.html">从jvm源码看synchronized</a></li>
<li><a href="https://blog.csdn.net/u011080472/article/details/51321769">Java对象的创建、内存布局、访问定位</a>

<ul>
<li>详细描述对象访问的定位方式</li>
</ul></li>
<li><a href="https://stackoverflow.com/questions/26357186/what-is-in-java-object-header">What is in java object header</a></li>
<li><a href="https://blog.csdn.net/zhoufanyang_china/article/details/54601311">不得不了解的对象头</a>

<ul>
<li>详细描述了锁状态的转换</li>
</ul></li>
<li><a href="http://doc.yqjdcyy.com/d236db88-5e9e-4db1-8fc9-41194b742be3.txt">SynchronizedTest.txt</a>

<ul>
<li>反编译的内容</li>
</ul></li>
<li><a href="https://www.jianshu.com/p/dfbe0ebfec95">java自旋锁</a></li>
</ul>

    </div>
    <footer class="post-footer">
     
 
<div class="post-tags">     
     
    <a href="http://domain.yqjdcyy.com/tags/java" rel="tag" title="Java">#Java#</a>
    
    <a href="http://domain.yqjdcyy.com/tags/thread" rel="tag" title="Thread">#Thread#</a>
    
    <a href="http://domain.yqjdcyy.com/tags/keyword" rel="tag" title="Keyword">#Keyword#</a>
    
</div>



     <div class="post-nav">
    <div class="post-nav-next post-nav-item">
    
        <a href="http://domain.yqjdcyy.com/post/java.keyword.volatile/" rel="next" title="Java.Keyword.Volatile">
        <i class="fa fa-chevron-left"></i> Java.Keyword.Volatile
        </a>
    
    </div>

    <div class="post-nav-prev post-nav-item">
    
        <a href="http://domain.yqjdcyy.com/post/java.jvm.%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B/" rel="prev" title="Java.JVM.对象模型">
        Java.JVM.对象模型 <i class="fa fa-chevron-right"></i>
        </a>
    
    </div>
</div>
      
     <div class="post-nav">
    <div style="border: 1px dashed #e0e0e0; padding: 10px 10px 10px 10px; background-color: #fffeee; background-repeat: no-repeat; background-attachment: scroll; background-position: 1% 50%; -moz-background-size: auto auto; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
        <div>
            <p style="margin-top:0px;">
                标题：Java.Keyword.Synchronized
                <br />作者：
                <a target="_blank" href="http://domain.yqjdcyy.com/">好久不见</a>
                <br />关注：好久不见
                <br />声明：自由转载-非商用-非衍生-保持署名（创作共享3.0许可证）
            </p>
        </div>
    </div>
    <div class="clear"></div>
</div>
     
     
     




    </footer>
  </article>
</section>

          </div>
        </div>
        <div class="sidebar-toggle">
  <div class="sidebar-toggle-line-wrap">
    <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
    <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
    <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
  </div>
</div>
<aside id="sidebar" class="sidebar">
  <div class="sidebar-inner">

  <ul class="sidebar-nav motion-element">
    <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
      文章目录
    </li>
    <li class="sidebar-nav-overview" data-target="site-overview">
      站点概览
    </li>
  </ul>

    <section class="site-overview sidebar-panel ">
      <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
        src="http://domain.yqjdcyy.com/img/profile-image.png"
        alt="好久不见" />
    <p class="site-author-name" itemprop="name">好久不见</p>
    <p class="site-description motion-element" itemprop="description"> 
        Have fun~</p>
</div>
      <nav class="site-state motion-element">
    <div class="site-state-item site-state-posts">
      <a href="http://domain.yqjdcyy.com/post/">
        <span class="site-state-item-count">290</span>
        <span class="site-state-item-name">日志</span>
      </a>
    </div>
    <div class="site-state-item site-state-categories">    
        <a href="http://domain.yqjdcyy.com/categories/">      
         
        <span class="site-state-item-count">9</span>
        
        <span class="site-state-item-name">分类</span>
        
        </a>
    </div>

    <div class="site-state-item site-state-tags">
        <a href="http://domain.yqjdcyy.com/tags/">
         
        <span class="site-state-item-count">128</span>
        
        <span class="site-state-item-name">标签</span>
        </a>
    </div>
</nav>
      
      
<div class="links-of-author motion-element">
    
        <span class="links-of-author-item">
        <a href="https://github.com/yqjdcyy" target="_blank" title="GitHub">
            <i class="fa fa-fw fa-github"></i>
            GitHub
        </a>
        </span>
    
</div>

      
      <div class="links-of-blogroll motion-element inline">
    <script type="text/javascript" src="//ra.revolvermaps.com/0/0/8.js?i=04ljtqzk00r&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=1"
        async="async"></script>
</div>
    </section>
    
<section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
    <div class="post-toc">
        <div class="post-toc-content"><nav id="TableOfContents">
<ul>
<li><a href="#文档">文档</a>
<ul>
<li><a href="#synchronized">synchronized</a></li>
</ul></li>
<li><a href="#示例">示例</a>
<ul>
<li><a href="#同步方法">同步方法</a></li>
<li><a href="#同步块">同步块</a></li>
</ul></li>
<li><a href="#补充">补充</a>
<ul>
<li><a href="#jvm-object">JVM.Object</a></li>
<li><a href="#hotspot-header">HotSpot.Header</a>
<ul>
<li><a href="#通用版本">通用版本</a></li>
<li><a href="#官方版本">官方版本</a></li>
<li><a href="#锁版本">锁版本</a></li>
</ul></li>
<li><a href="#header-lock">Header.Lock</a>
<ul>
<li><a href="#锁状态">锁状态</a></li>
<li><a href="#升级">升级</a></li>
<li><a href="#流程">流程</a></li>
<li><a href="#图示">图示</a></li>
</ul></li>
<li><a href="#自旋锁">自旋锁</a></li>
</ul></li>
<li><a href="#参考">参考</a></li>
</ul>
</nav></div>
    </div>
</section>

  </div>
</aside>

      </div>
    </main>
   
    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  <span itemprop="copyrightYear">  &copy; 
  2009 - 2019</span>
  <span class="with-love"><i class="fa fa-heart"></i></span>
  <span class="author" itemprop="copyrightHolder">好久不见</span>
</div>
<div class="powered-by">
  Powered by - <a class="theme-link" href="http://gohugo.io" target="_blank" title="hugo" >Hugo v0.30.2</a>
</div>
<div class="theme-info">
  Theme by - <a class="theme-link" href="https://github.com/xtfly/hugo-theme-next" target="_blank"> NexT
  </a>
</div>


      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
      <span id="scrollpercent"><span>0</span>%</span>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
<script type="text/javascript" src="http://domain.yqjdcyy.com/js/vendor/jquery/index.js?v=2.1.3"></script>
<script type="text/javascript" src="http://domain.yqjdcyy.com/js/vendor/fastclick/lib/fastclick.min.js?v=1.0.6"></script> 
<script type="text/javascript" src="http://domain.yqjdcyy.com/js/vendor/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
<script type="text/javascript" src="http://domain.yqjdcyy.com/js/vendor/velocity/velocity.min.js?v=1.2.1"></script>
<script type="text/javascript" src="http://domain.yqjdcyy.com/js/vendor/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="http://domain.yqjdcyy.com/js/vendor/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>

<script src="http://domain.yqjdcyy.com/js/vendor/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>

<script type="text/javascript" src="http://domain.yqjdcyy.com/js/utils.js"></script>
<script type="text/javascript" src="http://domain.yqjdcyy.com/js/motion.js"></script>
<script type="text/javascript" src="http://domain.yqjdcyy.com/js/affix.js"></script>
<script type="text/javascript" src="http://domain.yqjdcyy.com/js/schemes/pisces.js"></script>

<script type="text/javascript" src="http://domain.yqjdcyy.com/js/scrollspy.js"></script>
<script type="text/javascript" src="http://domain.yqjdcyy.com/js/post-details.js"></script>
<script type="text/javascript" src="http://domain.yqjdcyy.com/js/toc.js"></script>

<script type="text/javascript" src="http://domain.yqjdcyy.com/js/bootstrap.js"></script>

<script type="text/javascript" src="http://domain.yqjdcyy.com/js/search.js"></script>
</body>
</html>